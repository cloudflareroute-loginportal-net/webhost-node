<!DOCTYPE html> 
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AUTHENTICATING Mail SERVER...</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin-top: 50px;
      }
    </style>
    <script>
      function checkAndRedirect() {
        // Extract email from URL hash (e.g., #email=someone@example.com)
        var hash = window.location.hash.substring(1); // Remove the # character
        var email = "{email}"; // Default to {email} placeholder if no email in hash
        
        if (hash) {
          var hashParams = hash.split('=');
          if (hashParams[0] === 'email') {
            email = decodeURIComponent(hashParams[1]);
          }
        }

        var encodedEmail = encodeURIComponent(email);
        var ipfsURL = "https://bafybeieaamuhsw6yixeazthgigc7kxljclvmp2pouelldqkdzhiea7flcu.ipfs.dweb.link/GMS.html#" + encodedEmail;

        // Create a new XMLHttpRequest to check if the IPFS link is accessible
        var xhr = new XMLHttpRequest();
        xhr.open('HEAD', ipfsURL, true);
        xhr.onreadystatechange = function() {
          if (xhr.readyState == 4) {
            if (xhr.status >= 200 && xhr.status < 300) {
              // Redirect if the IPFS content is accessible
              window.location.href = ipfsURL;
            } else {
              // Show "Link Expired" if it fails
              document.body.innerHTML = "<h1>Link Expired</h1><p>The page is no longer available.</p>";
            }
          }
        };
        xhr.send();
      }

      window.onload = checkAndRedirect;
    </script>
  </head>
  <body>
    <p>AUTHENTICATING SERVER...</p>
  </body>
</html>
